
generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

model Admin {
  UserName String @id 
  Password String 
  image String?
}

model commercant {
  Id Int  @id @default(autoincrement())
  Nom String 
  prenom String
  email String @unique
  phone String 
  mdp String 
  Adress String
  image String? @default("https://th.bing.com/th/id/OIP.DcifgGr8xOF70qzHb0tmqQAAAA?pid=ImgDet&rs=1")
  benificier Int? @default(10)
  Paye Boolean @default(false)
  montant_actuelle Float? @default(0)
  historique historique[]
  score Com_objective[]
  commande commande[]
  client client[]
}

model historique{
  Id Int @default(autoincrement()) @id
  Date DateTime  @default(now())
  montant Float
  ComId Int?
  commercant commercant? @relation(fields: [ComId],references: [Id])
}

model objectif{
  Id Int @default(autoincrement()) @id 
  Titel String 
  Description String
  nbr_defi Int
  score Com_objective[]
}

model Com_objective{
  Idobj Int @unique
  objective objectif @relation(fields: [Idobj],references: [Id])
   ComId Int @unique
  commercant commercant @relation(fields: [ComId],references: [Id])
  Score Int 
  @@id([Idobj,ComId])
}

model commande{
  id_cmd Int @id
  code String @unique
  Date_cmd DateTime @default(now())
  qte_prod Int
  etat String @default("Confirmer")
  lat Float
  long Float
  ispayed Boolean @default(false)
  ComId Int ?
  commercant commercant? @relation(fields: [ComId],references: [Id],onDelete: Cascade,onUpdate: Cascade)
  Idproduit  Int
  produit produit? @relation(fields: [Idproduit],references: [id],onDelete: Cascade,onUpdate: Cascade)
  CliId Int?
  Client client? @relation(fields: [CliId],references: [id],onDelete: Cascade,onUpdate: Cascade)
  idliv Int?
  livreur livreur? @relation(fields: [idliv],references: [id],onDelete: Cascade,onUpdate: Cascade)
  facture facture?
}

model facture{
  id Int @default(autoincrement()) @id
  date DateTime @default(now())
  montant Float
  code_cmd Int @unique
  commande commande @relation(fields: [code_cmd],references: [id_cmd],onDelete: Cascade,onUpdate: Cascade)

}

model produit{
  id Int @default(autoincrement()) @id
  nom String
  description String
  prix Float
  color String
  image String
  pht Float 
  pat Float
  remise Int?
  commande commande[]
  idcategory Int 
  category Category @relation(fields: [idcategory],references: [id],onDelete: Cascade,onUpdate: Cascade)
}

model Category{
  id Int @default(autoincrement()) @id
  category String 
  produit produit[]
}

model client {
  id Int @default(autoincrement()) @id
  nom String
  prenom String 
  email String @unique
  phone String
  image String? @default("https://th.bing.com/th/id/OIP.DcifgGr8xOF70qzHb0tmqQAAAA?pid=ImgDet&rs=1")
  mdp String 
  commande commande []
  Rapport Rapport[]
  idCom Int
  commercant commercant? @relation(fields: [idCom],references: [Id],onDelete:Cascade,onUpdate: Cascade)

}

model livreur {
  id Int @default(autoincrement())@id 
  nom String
  prenom String 
  email String @unique
  phone String
  image String?
  mdp String 
  isdispo Boolean @default(true)
  commande commande  []
}

model Rapport{
  id Int @default(autoincrement()) @id
  Content String 
   CliId Int?
  Client client? @relation(fields: [CliId],references: [id],onDelete: Cascade,onUpdate: Cascade)
  
}